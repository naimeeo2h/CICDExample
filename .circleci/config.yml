version: 2.1

jobs:

  build-android:
    docker:
      - image: cimg/android:2022.09.2-node
      #- image: cimg/ruby:2.7.5-node
      #- image: cimg/android:2022.09.2-node
      #- image: cimg/base:stable
      #- image: cimg/node:20.0.0
      #- image: cimg/android:2022.09.2-node
      #- image: circleci/ruby:2.7.5
      #- image: circleci/ruby:2.7.5-node-browsers

    steps:
      - checkout
      
      #- run: gem install bundler
      #- run: bundle install
      #- run: bundle exec rspec
      #- run:
          #name: Install Dependencies
          #command: |
           # bundle install
           # npm install
      #- run:
          #name: Run Tests
         # command: |
          #  npm test
      - run:
          name: Install Dependencies
          command: npm install
      - run:
         name: Add keystore for release build
         command: |
            cd android
            echo $RELEASE_KEYSTORE_BASE64 | base64 --decode > clinoverseRelease.keystore
      - run:
          name: Build for android
          command: |
            cd android
            ./gradlew assembleRelease
      #- save_cache:
        #  key: *jars-cache
        #  paths:
         #   - ~/.gradle
          #  - android/.gradle
          #  - android/build-cache
          
      - store_artifacts:
          path: android/app/build/outputs/apk/release/app-release.apk
          
workflows:
  build:
    jobs:
      - build-android
      #- build-ios